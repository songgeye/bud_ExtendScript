# bud_ExtendScript - Photoshop自動化スクリプト

1. 概要
このスクリプトは、Adobe Photoshopにおける複数画像の処理を自動化するために設計されています。ユーザーは処理対象の画像が含まれるソースフォルダと、処理済み画像を保存する出力先フォルダを選択するだけで、指定された処理（例：リサイズ、フォーマット変換、フィルター適用など、スクリプトの具体的な機能によります）を各画像に一括で適用できます。手作業による大量の画像処理は時間がかかり、繰り返し作業になりがちです。このスクリプトは、そのようなワークフローを効率化し、貴重な時間を節約するとともに、画像間の一貫性を保つのに役立ちます。主な利点は、数クリックで画像のバッチ処理を実行できるようになり、生産性が向上することです。このドキュメントは、スクリプトの明確な使用方法を提供し、ユーザーがその機能を最大限に活用できるようにすることを目的としています。

2. 主な機能このスクリプトが提供する主な機能は以下の通りです。
バッチ処理: 選択された入力フォルダ内の対応するすべての画像ファイルを処理します。
入力フォルダ選択: 処理対象の画像が含まれるソースフォルダを簡単に選択できるダイアログを提供します 3。
出力フォルダ選択: 処理済み画像を保存する先のフォルダを簡単に指定できるダイアログを提供します 3。
[特定の処理1]: 例：画像リサイズ - 事前定義された寸法や指定されたパーセンテージに画像を自動的にリサイズします 4。
[特定の処理2]: 例：フォーマット変換 - 画像を指定された出力フォーマット（例：JPG、PNG、TIFF）に変換します 5。
[特定の処理3]: 例：レイヤー処理 - 非表示レイヤーを無視したり、保存前に画像を統合したりするオプションを提供します 4。
[命名規則オプション]: 例：出力ファイル名のカスタマイズ - 接頭辞/接尾辞の追加、元の名前の維持など、出力ファイル名をカスタマイズできます 6。
これらの機能は、ユーザーが特定のニーズに合わせてスクリプトを活用できるように設計されています 2。3. 動作環境このスクリプトを正常に実行するためには、以下の環境が必要です。
Adobe Photoshop バージョン:

Adobe Photoshop [バージョンを指定、例: CC 2021 (v22.0) 以降] での使用を推奨します。
古いバージョンでも動作する可能性がありますが、互換性は保証されていません。最適なパフォーマンスと互換性のために、Photoshop CCの最新バージョンの使用をお勧めします 4。


オペレーティングシステム:

Windows および macOS の両方に対応しています。


スクリプトファイル:

スクリプトファイル ([スクリプト名].jsx) が必要です。


権限:

Photoshopが選択された入力フォルダおよび出力フォルダに対して、必要な読み取り/書き込み権限を持っていることを確認してください。これはスクリプトが正常にファイルを処理し、保存するために不可欠です。


これらの要件を事前に確認することで、スクリプト実行時の問題を未然に防ぐことができます 2。4. インストールスクリプトをPhotoshop内で利用可能にするための手順は以下の通りです。

スクリプトのダウンロード:

スクリプトファイル [スクリプト名].jsx を [スクリプトの入手元 - 例: GitHubリポジトリ、ウェブサイトのリンク] からダウンロードします。
ダウンロードしたファイルの拡張子が .jsx であることを確認してください。一部のブラウザは誤って .txt として保存したり、他の拡張子を追加したりする場合があります。その場合は、ファイル名を [スクリプト名].jsx に変更してください 4。



スクリプトファイルの配置:

Photoshopの ファイル > スクリプト メニューからスクリプトに簡単にアクセスできるようにするには、.jsx ファイルをPhotoshopの Scripts フォルダに配置します。一般的な場所は以下の通りです 4:

Windows: C:\Program Files\Adobe\Adobe Photoshop [ご使用のバージョン]\Presets\Scripts\
macOS: /Applications/Adobe Photoshop [ご使用のバージョン]/Presets/Scripts/


代替案 (参照して実行): Presets/Scripts フォルダにインストールしたくない場合は、.jsx ファイルを任意の場所に保存し、毎回 ファイル > スクリプト > 参照... コマンドを使用してその場所を指定して実行することも可能です。ただし、定期的に使用する場合は、インストールすることをお勧めします。この方法は、ユーザーが最初に指定した実行方法でもあります 1。



Photoshopの再起動 (推奨):

スクリプトを Presets/Scripts フォルダに配置した後、Photoshopを再起動することをお勧めします。これにより、スクリプトが ファイル > スクリプト メニューに表示されるようになります。


明確なインストール手順に従うことで、特に技術的な知識が少ないユーザーでもスムーズにスクリプトを利用開始できます 2。.jsx 拡張子の問題に注意することは、事前のトラブルシューティングとして重要です。5. スクリプトの実行方法このスクリプトを実行するための詳細な手順は以下の通りです。ユーザーが提供した基本操作を拡張しています。

Adobe Photoshopの起動:

Photoshopが起動していることを確認してください。



スクリプトへのアクセス:

インストール済みの場合: ファイル > スクリプト > [スクリプト名] を選択します（Presets/Scripts フォルダに配置し、Photoshopを再起動した場合、このリストに表示されます）。
未インストールの場合 (参照して実行): ファイル > スクリプト > 参照... を選択します 1。



スクリプトファイルの選択 (参照を使用する場合):

参照... を選択した場合、ファイルダイアログが開きます。[スクリプト名].jsx を保存した場所に移動し、ファイルを選択して 開く をクリックします。



入力フォルダの選択:

スクリプトを起動すると、処理したい画像が含まれるフォルダを選択するよう求められます。
「ソースフォルダを選択」 または 「入力フォルダを選択」 のようなタイトルのダイアログボックスが表示されます（正確な文言はオペレーティングシステムによって若干異なる場合があります）3。
目的の入力フォルダに移動し、それを選択して フォルダを選択 (または OK/選択) をクリックします。
重要: このフォルダに処理対象の画像ファイルが含まれていることを確認してください。スクリプトはこのフォルダ内の対応画像形式を探します（スクリプトが対応していれば、サブフォルダも対象となる場合があります。スクリプトの動作に基づいて明確にしてください）。



出力フォルダの選択:

次に、処理された画像を保存するフォルダを選択するよう求められます。
「保存先フォルダを選択」 または 「出力フォルダを選択」 のようなタイトルのダイアログボックスが表示されます 3。
目的の出力フォルダに移動し（または新規作成し）、それを選択して フォルダを選択 (または OK/選択) をクリックします。
ヒント: 元のファイルとの混同を避けるため、空のフォルダまたは専用の出力フォルダを使用することをお勧めします。



スクリプトの実行:

入力フォルダと出力フォルダの両方を選択すると、スクリプトが画像の処理を開始します。
画像の数や操作の複雑さによっては、時間がかかる場合があります。処理中、Photoshopがビジー状態になったり応答しなくなったりするように見えることがありますが、しばらくお待ちください。
[任意: スクリプトが進捗表示を提供する場合に追加] 一部のスクリプトは、Photoshop内にプログレスバーやメッセージを表示することがあります。そうでない場合は、出力フォルダを監視してファイルが表示されるのを確認する必要があるかもしれません。



確認/完了:

完了すると、スクリプトが確認メッセージ（例: 「処理が完了しました！X個の画像を処理しました。」）を表示することがあります。表示されない場合は、出力フォルダで処理済みファイルを確認してください 7。


この手順は、特にフォルダ選択の2段階のプロセスを明確に示しており、ユーザーがエラーなくスクリプトを実行できるようにすることを目的としています。6. 設定オプション (該当する場合)このスクリプトは、その動作をカスタマイズするためのいくつかの設定オプションを提供している場合があります。これらのオプションは、スクリプト開始時にダイアログボックスで表示されるか、Photoshopのレイヤー名に特定の命名規則を使用することで制御される場合があります。ダイアログベースのオプション (例):スクリプトが設定ダイアログを表示する場合、以下のようなオプションが表示されることがあります。
画質 (JPGの場合): JPEGの品質を設定するためのスライダーまたはドロップダウン（例: 0-12、または低/中/高）。
リサイズ寸法: リサイズ後の目標幅と高さを入力するフィールド。
既存ファイルを上書き: 出力フォルダ内の同名ファイルを上書きすることを許可または禁止するチェックボックス 8。
非表示レイヤーを無視: 表示されていないレイヤーの処理をスキップするチェックボックス 4。
レイヤー命名規則 (例、Spineスクリプトに触発されたもの):一部の高度な機能は、スクリプトを実行する前にPhotoshopでレイヤーやグループにどのように名前を付けるかによって制御される場合があります。例：
[ignore]: レイヤー名またはグループ名に [ignore] を追加すると、スクリプトがそれをスキップする場合があります 4。
[scale:50%]: レイヤー名を [scale:50%] とすると、特定の拡大縮小率が適用される場合があります 4。
対応するレイヤータグの完全なリストについては、[スクリプトがこれを使用する場合の特定のドキュメント/セクション] を参照してください。表: 設定パラメータスクリプトに複数のパラメータがある場合、以下の表は非常に役立ちます。情報を一元化し、オプションを一目で理解しやすくします 2。パラメータ / 設定説明設定方法（ダイアログ/レイヤー名）デフォルト値選択肢（もしあれば）例: 出力フォーマット出力画像のファイル形式を指定します。ダイアログのドロップダウンJPGJPG, PNG, TIFF例: 非表示レイヤーを無視チェックすると、非表示レイヤーは処理されません。ダイアログのチェックボックスオンオン/オフ例: レイヤータグ [ignore]レイヤー名の先頭に [ignore] を付けるとスキップします。レイヤー名N/A[ignore] プレフィックス追加これらのオプションを文書化することで、ユーザーはスクリプトの全機能を理解し、予期しない動作を避けることができます。7. 対応入力ファイル形式このスクリプトが正常に読み取り、処理できる画像ファイル形式は以下の通りです。一般的に対応している形式:このスクリプトは、以下の一般的な画像ファイル形式を処理するように設計されています。
JPEG (.jpg, .jpeg)
PNG (.png)
TIFF (.tif, .tiff)
Photoshopドキュメント (.psd)
（一般的なPhotoshopバッチ処理のニーズと一般的なサポートに基づくリスト 3）。対応の可能性がある形式 (スクリプトで要確認):スクリプトは、ご使用のPhotoshopバージョンが開くことができる他の形式（GIF、BMP、WebP、HEICなど）もサポートする可能性があります。ただし、上記に記載されていない限り、これらは明示的にテストされていません。注意:
入力ファイルが対応形式のいずれかであることを確認してください。対応していない形式のファイルは、無視されるか、エラーを引き起こす可能性があります。
対応形式を明確にすることで、ユーザーは入力データを正しく準備でき、エラーや予期せぬ結果を防ぐことができます 5。スクリプトはPhotoshop自体のファイル読み込み能力に依存していることに注意してください 10。8. 出力詳細このセクションでは、スクリプト実行後に出力フォルダに何が生成されるかについて説明します。

出力ファイル形式:

デフォルトでは、スクリプトは処理済み画像を [デフォルトの出力形式を指定、例: JPEG] として保存します。
設定可能な場合、PNGやTIFFなどの他の出力形式を選択できる場合があります（設定オプションを参照）。



出力ファイル名:

処理済みファイルは、選択された出力フォルダに保存されます。
出力ファイルの命名規則は通常、以下のいずれかです。

オプション1 (元の名前を維持): 元のファイル名と同じ（例: image.jpg が image.jpg になります）。
オプション2 (接尾辞/接頭辞を追加): 元のファイル名に接尾辞を追加（例: image.jpg が image_processed.jpg になります）6。
オプション3 (ユーザー定義): 設定ダイアログで選択したオプションに基づきます。


（このスクリプトが使用する実際の命名規則を指定してください。）



ファイル上書きの動作:

重要: 出力フォルダ内の同名ファイルに関して：

シナリオA (上書き): スクリプトは、出力ファイルと同名の既存ファイルを出力フォルダ内で警告なしに上書きします 9。
シナリオB (上書きしない/名前変更): スクリプトは既存ファイルを上書きしません。処理をスキップするか、ファイル名に番号を追加する（例: image_1.jpg）、またはユーザーに確認を求める場合があります。
シナリオC (設定可能): 動作はスクリプトオプションで設定可能です。


（このスクリプトの実際の上書き動作を指定してください。これは非常に重要な情報です。）
推奨: 偶発的なデータ損失を避けるため、出力先として空のフォルダまたは新しいフォルダを指定することを強くお勧めします。



出力品質/パラメータ:

該当する場合、出力ファイルは `` で生成されます 6。


出力に関する不確実性（命名、形式、上書き）は、ユーザーに大きな不安を与え、潜在的なデータ損失を引き起こす可能性があります。このセクションは非常に正確である必要があり、特に上書きの動作は重要です。

9. トラブルシューティング / よくある問題
ユーザーが遭遇する可能性のある一般的な問題とその解決策を以下に示します。
表: よくある問題と解決策
問題 / エラーメッセージ考えられる原因提案される解決策ファイル > スクリプト メニューにスクリプトが見つからない- スクリプトが正しい Presets/Scripts フォルダに配置されていない。<br>- スクリプト配置後にPhotoshopが再起動されていない。- スクリプトファイル ([スクリプト名].jsx) が正しいPhotoshopの Presets/Scripts フォルダにあることを確認してください（パスはインストールセクション参照）。<br>- Photoshopを再起動してください。<br>- または、ファイル > スクリプト > 参照... を使用して直接実行してください。「ファイルまたはフォルダが見つかりません」エラー- 入力フォルダのパスが間違っているか、アクセスできない。<br>- 出力フォルダのパスが間違っているか、アクセスできない。- 選択した入力フォルダと出力フォルダが存在し、読み取り/書き込み権限があることを再確認してください。<br>- 問題が解決しない場合は、フォルダ名やパスに特殊文字を使用しないでください。スクリプトは実行されるが出力ファイルがない / 一部のファイルがスキップされる- 入力ファイルが対応形式ではない。<br>- 非表示レイヤーが無視されている（オプションの場合）。<br>- 入力ファイルに「読み取り専用」属性が付いている。<br>- 出力先のディスク容量が不足している。- 入力ファイルが対応入力ファイル形式に含まれていることを確認してください。<br>- スクリプトに非表示レイヤーを処理するオプションがある場合、ニーズに合わせて正しく設定されていることを確認してください。<br>- 入力ファイルが「読み取り専用」に設定されていないことを確認してください。<br>- 利用可能なディスク容量を確認してください。エラーメッセージ: 「」- スクリプトのバグ。<br>- 予期しないファイル内容（例: 破損した画像）。<br>- 他のプラグインやPhotoshop設定との競合。- 正確なエラーメッセージをメモしてください。<br>- 問題を特定するために、単一の正常な画像で処理を試してください。<br>- エラーが特定の行を指している場合 4、これはデバッグに役立ちます。<br>- 他のサードパーティ製プラグインを無効にしてみてください。<br>- エラーメッセージと再現手順を添えて、スクリプト開発者に問題を報告してください。Photoshopがクラッシュする、または応答しなくなる- スクリプトが非常に大きなファイルや複雑な操作に遭遇している。<br>- スクリプトのバグ、またはスクリプトによってトリガーされたPhotoshopのバグ。<br>- システムリソースの不足（RAM、CPU）。- まず、より少ない画像バッチまたはより単純な画像で試してください。<br>- システムがPhotoshopの最小要件を満たしていることを確認してください。<br>- リソースを解放するために他のアプリケーションを閉じてください。<br>- デバッグの最終手段として、Adobe ExtendScript Toolkit (ESTK) を使用してスクリプトをステップ実行できます 1（これは高度な操作です）。<br>- Photoshopのアップデートを確認してください。<br>- 頻繁なクラッシュを報告してください。権限拒否 / ファイルを保存できない- Photoshopが出力フォルダへの書き込み権限を持っていない。<br>- 出力フォルダが読み取り専用のドライブ/ネットワーク上にある。- 書き込み権限のある別の出力フォルダ（例: デスクトップやドキュメントフォルダ）を選択してください。<br>- オペレーティングシステムで出力フォルダの権限を確認してください。
一般的なトラブルシューティング手順:
Photoshopの再起動: 多くの場合、一時的な不具合が解決します。
Photoshopバージョンの確認: 対応するバージョンのPhotoshopを使用していることを確認してください（動作環境を参照）。
単一ファイルでのテスト: バッチ処理が失敗する場合、問題が特定のファイルにあるのか、バッチ処理自体にあるのかを切り分けるために、単一の単純な画像でスクリプトを試してください。
アップデートの確認: Photoshopとオペレーティングシステムが最新の状態であることを確認してください。
デバッグ (高度なユーザー向け):上級ユーザーまたは開発者向け: スクリプトがエラーで失敗した場合、Photoshopのバージョンに付属していれば、Adobe ExtendScript Toolkit (ESTK) を通じて実行することで、より詳細な情報を得られることがあります。ESTKを使用すると、スクリプトを1行ずつステップ実行してエラー発生箇所を特定できます 1。このセクションは、ユーザーが自身で問題を解決できるようにし、フラストレーションを軽減し、直接的なサポートの必要性を減らすことを目的としています。特に「権限拒否」の問題は、ファイルI/Oスクリプトで非常に一般的です。
